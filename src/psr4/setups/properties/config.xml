<?xml version="1.0" encoding="UTF-8" ?>

  <project>

    <!-- ============================================  -->
    <!-- Configuration. -->
    <!-- ============================================  -->

    <if>
      <and>
        <not>
          <isset property="_setups_properties_config_complete" />
        </not>
      </and>
      <then>
        <!-- Property values. -->

        <property file="${project.basedir}/.build.props" />

        <!-- WordPress theme/plugin detection. -->

        <if>
          <or>
            <isset property="project_wp_required_version" />
            <isset property="project_wp_tested_up_to_version" />
          </or>
          <then>
            <property name="_is_wp_theme_plugin" value="true" />
          </then>
          <else>
            <property name="_is_wp_theme_plugin" value="false" />
          </else>
        </if>
        <!-- WordPress WP Sharks Core theme/plugin detection. -->

        <if>
          <and>
            <istrue value="${_is_wp_theme_plugin}" />
            <or>
              <isset property="project_wp_sharks_core_required_version" />
              <isset property="project_wp_sharks_core_tested_up_to_version" />
              <isset property="project_wp_sharks_core_max_compatible_version" />
            </or>
          </and>
          <then>
            <property name="_is_wp_sharks_core_theme_plugin" value="true" />
          </then>
          <else>
            <property name="_is_wp_sharks_core_theme_plugin" value="false" />
          </else>
        </if>
        <!-- Lite detection; i.e., is applicable? -->

        <if>
          <and>
            <not>
              <isset property="_is_lite_build" />
            </not>
            <or>
              <isset property="project_lite_title" />
              <isset property="project_lite_slug" />

              <isset property="project_lite_namespace" />
              <isset property="project_lite_sub_namespace" />

              <isset property="project_lite_other_phar_fileset_exclusions" />
              <isset property="project_lite_other_zip_tgz_fileset_exclusions" />

              <isset property="project_lite_text_domain_regex_replacement_pattern" />
              <isset property="project_lite_alter_namespace_in_other_files_pattern" />
            </or>
          </and>
          <then>
            <property name="_has_lite_build_props" value="true" />
          </then>
          <else>
            <property name="_has_lite_build_props" value="false" />
          </else>
        </if>
        <!-- Make sure optional properties are defined. -->

        <if>
          <not>
            <isset property="project_other_phar_fileset_exclusions" />
          </not>
          <then>
            <property name="project_other_phar_fileset_exclusions" value="" />
          </then>
        </if>
        <if>
          <not>
            <isset property="project_other_zip_tgz_fileset_exclusions" />
          </not>
          <then>
            <property name="project_other_zip_tgz_fileset_exclusions" value="" />
          </then>
        </if>
        <!-- Make sure optional lite properties are defined. -->

        <if>
          <and>
            <not>
              <isset property="_is_lite_build" />
            </not>
            <istrue value="${_has_lite_build_props}" />
          </and>
          <then>
            <if>
              <not>
                <isset property="project_lite_other_phar_fileset_exclusions" />
              </not>
              <then>
                <property name="project_lite_other_phar_fileset_exclusions" value="" />
              </then>
            </if>
            <if>
              <not>
                <isset property="project_lite_other_zip_tgz_fileset_exclusions" />
              </not>
              <then>
                <property name="project_lite_other_zip_tgz_fileset_exclusions" value="" />
              </then>
            </if>
            <if>
              <not>
                <isset property="project_lite_text_domain_regex_replacement_pattern" />
              </not>
              <then>
                <property name="project_lite_text_domain_regex_replacement_pattern" value="" />
              </then>
            </if>
            <if>
              <not>
                <isset property="project_lite_alter_namespace_in_other_files_pattern" />
              </not>
              <then>
                <property name="project_lite_alter_namespace_in_other_files_pattern" value="" />
              </then>
            </if>
          </then>
        </if>
        <!-- Make sure optional WP Sharks core properties are defined. -->

        <if>
          <and>
            <istrue value="${_is_wp_theme_plugin}" />
            <istrue value="${_is_wp_sharks_core_theme_plugin}" />
          </and>
          <then>
            <if>
              <not>
                <isset property="project_wp_sharks_core_max_compatible_version" />
              </not>
              <then>
                <property name="project_wp_sharks_core_max_compatible_version" value="" />
              </then>
            </if>
          </then>
        </if>
        <!-- Properties derived from other properties. -->

        <if>
          <and>
            <isset property="project_slug" />
          </and>
          <then>
            <php expression="preg_replace('/\-(?:lite|pro)$/ui', '', '${project_slug}')" returnproperty="_project_text_domain" />
          </then>
          <else>
            <property name="_project_text_domain" value="" />
          </else>
        </if>
        <!-- Property replacement codes. -->

        <if>
          <and>
            <isset property="project_version" />
          </and>
          <then>
            <php expression="str_replace('%y%m%d', date('ymd'), '${project_version}')" returnproperty="project_version" />
          </then>
        </if>

        <!-- Codex ignore list. -->

        <property name="_codex_ignore" value="*/assets/*,*/phings/*,*/tests/*,*/vendor/*" />

        <!-- Flag complete. -->

        <property name="_setups_properties_config_complete" value="true" />

      </then>
    </if>

  </project>
