<?xml version="1.0" encoding="UTF-8" ?>

  <project name="dotbuilds">

    <!-- ============================================  -->
    <!-- Iterator over all `.build.php` files. -->
    <!-- ============================================  -->

    <target name="-dotbuilds" hidden="true">

      <!-- Iterate over all `.build.php` files. -->

      <echo msg="Running .build.php files in: ${project.basedir}" />

      <foreach target="--dotbuild" absparam="__abs_build_php" param="__build_php">
        <fileset dir="${project.basedir}" casesensitive="false">
          <exclude pattern="**/vendor/**" />
          <include pattern=".build.php" />
          <include pattern="**/.build.php" />
        </fileset>
      </foreach>

      <echo msg="------------------------------------" />

    </target>

    <!-- ============================================  -->
    <!-- Callback that runs a `.build.php` file. -->
    <!-- ============================================  -->

    <target name="--dotbuild" hidden="true">
      <echo msg="Running : ${__abs_build_php}" />

      <exec executable="php" dir="${project.basedir}" passthru="true" checkreturn="true">
        <arg value="${__abs_build_php}" />
      </exec>

      <echo msg="------------------------------------" />
    </target>

  </project>
